<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta
            name="viewport"
            content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0"
        />
        <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    </head>
    <style>
        body {
            background: #fff;
            padding: 0;
            margin: 0;
            overflow: hidden;
        }
    </style>
    <body>
        <!--
            These paths are to be used by clients, when using map bundle from CDN.
        -->
        <!--
            <script src="https://unpkg.com/three/build/three.min.js"></script>
            <script src="https://unpkg.com/@here/harp.gl/dist/harp.js"></script>
        -->
        <!--
            These paths are used here to be compatible with harp.gl CI.
        -->
        <script src="three.min.js"></script>
        <script src="harp.js"></script>

        <script>
            const hereCopyrightInfo = {
                id: "here.com",
                year: new Date().getFullYear(),
                label: "HERE",
                link: "https://legal.here.com/terms"
            };
            const xyzAccessToken = "AYlqpxvwl7C8tSVG22lX2lg";

            const map = new harp.Map(document.body, {
                themeUrl: "resources/berlin_tilezen_base.json",
                location: [40.6935, -74.009],
                zoomLevel: 16.9,
                cameraYaw: 6.3,
                cameraPitch: 50,
                dataSources: [
                    new harp.OmvDataSource({
                        baseUrl: "https://xyz.api.here.com/tiles/herebase.02",
                        apiFormat: harp.APIFormat.XYZOMV,
                        styleSetName: "tilezen",
                        maxZoomLevel: 17,
                        authenticationCode: xyzAccessToken,
                        copyrightInfo: [hereCopyrightInfo]
                    })
                ]
            });
            const infoElement = document.createElement("div");
            infoElement.style.position = "absolute";
            infoElement.style.right = "0";
            infoElement.style.top = "0";
            infoElement.style.backgroundColor = "#f0fef1";
            infoElement.style.zIndex = "400";
            infoElement.style.padding = "2px";
            infoElement.style.fontSize = "0.8em";
            infoElement.style.fontFamily = "sans-serif";
            document.body.appendChild(infoElement);

            function humanReadable(n) {
                return n.toPrecision(5).replace(/(\.)?0+$/, "");
            }
            map.addEventListener("camera-updated", () => {
                const location = map.geoCenter;
                infoElement.innerHTML = `
                    Lat: ${humanReadable(location.latitude)}<br>
                    Long: ${humanReadable(location.longitude)}<br>
                    Zoom: ${humanReadable(map.mapView.zoomLevel)}
                `;
            });
        </script>
    </body>
</html>
